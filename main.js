(()=>{"use strict";class e{constructor(e,t){var s,r;r=e=>{e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)},(s="_checkInputValidity")in this?Object.defineProperty(this,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[s]=r,this._form=t,this._settings=e,this._buttonElement=this._form.querySelector(this._settings.submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._settings.inputSelector))}_enableSubmitButton(){this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.removeAttribute("disabled",!0)}disableSubmitButton(){this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}_checkInputsContent(){return this._inputList.every((e=>0===e.value.length))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()||this._checkInputsContent()?this.disableSubmitButton():this._enableSubmitButton()}_showError(e,t){var s=this._settings,r=s.inputErrorClass,i=s.errorClass,n=this._form.querySelector("#".concat(e.id,"-error"));e.classList.add(r),n.textContent=t,n.classList.add(i)}_hideError(e){var t=this._settings,s=t.inputErrorClass,r=t.errorClass,i=this._form.querySelector("#".concat(e.id,"-error"));e.classList.remove(s),i.textContent="",i.classList.remove(r)}_setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._setEventListeners()}resetErrors(){this._inputList.forEach((e=>{this._hideError(e)}))}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,r){t(this,"_removeCardHandler",(()=>{this._cardElement.remove(),this._cardElement=null})),t(this,"_likeCardHandler",(()=>{this._cardLike.classList.toggle("cards__like_is-active")})),this._cardTemplate=document.querySelector(s).content,this._name=e.name,this._link=e.link,this._handleCardClick=r}_fillCard(){this._cardElement.querySelector(".cards__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name}_setEventListeners(){this._cardLike=this._cardElement.querySelector(".cards__like"),this._cardElement.querySelector(".cards__remove").addEventListener("click",this._removeCardHandler),this._cardLike.addEventListener("click",(()=>this._likeCardHandler())),this._cardImage.addEventListener("click",this._handleCardClick)}getView(){return this._cardElement=this._cardTemplate.querySelector(".cards__item").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".cards__image"),this._fillCard(),this._setEventListeners(),this._cardElement}}class r{constructor(e){this._popup=e,this._closePopupByEsc=this._closePopupByEsc(this)}_closePopupByEsc(e){"Escape"===e.key&&this.close}open(){document.addEventListener("keydown",this._closePopupByEsc),this._popup.classList.add("popup_is-opened")}close(){document.removeEventListener("keydown",this._closePopupByEsc),this._popup.classList.remove("popup_is-opened")}setEventListeners(){var e=this._popup.querySelector(".popup__close");this._popup.addEventListener("click",(t=>{t.target.closest(".popup__container")&&t.target!==e||this.close()}))}}class i extends r{constructor(e,t){super(e),this._submitHandler=t,this._form=this._popup.querySelector(".popup__form")}_getInputValues(){var e=[...this._form.querySelectorAll(".popup__field")],t={};return e.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(()=>{this._submitHandler(this._getInputValues())}))}close(){super.close(),this._form.reset()}}var n={formSelector:".popup__form",inputSelector:".popup__field",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__submit_disabled",inputErrorClass:"popup__field_type_error",errorClass:"popup__error_visible"},o=document.querySelector(".popup_type_big-image"),a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),_=document.querySelector(".popup_type_profile"),c=document.querySelector(".popup_type_add-card"),p=document.querySelector(".popup__form_type_profile"),u=document.querySelector(".popup__form_type_add-card"),d=document.querySelector(".popup__field_type_name"),h=document.querySelector(".popup__field_type_job"),m=document.querySelector(".cards"),v=new e(n,p),E=new e(n,u),y=new class extends r{open(e,t){var s=this._popup.querySelector(".popup__image"),r=this._popup.querySelector(".popup__caption");s.src=e,s.alt=t,r.textContent=t,super.open()}}(o),b=new class{constructor(e){var t=e.profileNameSelector,s=e.profileJobSelector;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}}({profileNameSelector:".profile__title",profileJobSelector:".profile__description"});v.enableValidation(),E.enableValidation();var f=e=>new s(e,"#card-template",(()=>{y.open(e.link,e.name)})).getView(),g=new i(c,(e=>{var t=f({link:e.link,name:e.place});k.addItem(t),g.close()})),S=new i(_,(e=>{var t=e.name,s=e.occupation;b.setUserInfo(t,s),S.close()})),k=new class{constructor(e,t){var s=e.items,r=e.renderer;this._initialArray=s,this._container=t,this._renderer=r}renderElements(){this._initialArray.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Рейкьявик",link:"https://3pulse.com/uploads/photo/19/99/00/2020/01/22/0230dba935.jpg"},{name:"Нью-Йорк",link:"https://upload.wikimedia.org/wikipedia/commons/8/83/The_Vessel_%28top-down_view%29%2C_Hudson_Yards%2C_New_York_City%2C_July_2019.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Каир",link:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/f4/Cairo_Tower_2011.JPG/135px-Cairo_Tower_2011.JPG"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Польша",link:"https://a.d-cd.net/_EAAAgGPvuA-1920.jpg"}],renderer:e=>{var t=f(e);m.prepend(t)}},m);k.renderElements(),y.setEventListeners(),g.setEventListeners(),S.setEventListeners(),a.addEventListener("click",(function(){var e=b.getUserInfo();d.value=e.name,h.value=e.job,S.open()})),l.addEventListener("click",(function(){E.disableSubmitButton(),E.resetErrors(),u.reset(),g.open()}))})();